rm(list=ls())

fun1<-function(n11,n12,n21,n22,n31,n32,v11,v12,v21,v22,v31,v32)
{
  g11<-rnorm(n11,0,sqrt(v11));g12<-rnorm(n12,0,sqrt(v12))
  g21<-rnorm(n21,0,sqrt(v21));g22<-rnorm(n22,0,sqrt(v22))
  g31<-rnorm(n31,0,sqrt(v31));g32<-rnorm(n32,0,sqrt(v32))
  s11=var(g11);s12=var(g12);s21=var(g21);s22=var(g22);s31=var(g31);s32=var(g32)
  S1=(s11/n11+s21/n21);S2=(s22/n22+s12/n12)
  S4=(s21/n21+s31/n31);S5=(s22/n22+s32/n32)
  X11=mean(g11);X12=mean(g12);X21=mean(g21);X22=mean(g22)
  X31=mean(g31);X32=mean(g32)
  T11=(X21-X11)/sqrt(S1);T12=(X22-X12)/sqrt(S2)
  T21=(X31-X21)/sqrt(S4);T22=(X32-X22)/sqrt(S5)
  # NNT-T value
  T.1=min(T11,T21);T.2=min(T12,T22)
  TNN=min(T.1,T.2,na.rm = FALSE)
  return(TNN)
}
fun2<-function(n11,n12,n21,n22,n31,n32,v11,v12,v21,v22,v31,v32)
{
  x<-replicate(1000,fun1(n11,n12,n21,n22,n31,n32,v11,v12,v21,v22,v31,v32))
  y<-sort(x,decreasing=FALSE)
  c<-y[950]
  return(c)
}

fun3<-function(n11,n12,n21,n22,n31,n32,mu11,mu12,mu21,mu22,mu31,mu32,v11,v12,v21,v22,v31,v32)
{
  g11<-rnorm(n11,mu11,sqrt(v11));g12<-rnorm(n12,mu12,sqrt(v12))
  g21<-rnorm(n21,mu21,sqrt(v21));g22<-rnorm(n22,mu22,sqrt(v22))
  g31<-rnorm(n31,mu31,sqrt(v31));g32<-rnorm(n32,mu32,sqrt(v32))
  s11=var(g11);s12=var(g12);s21=var(g21);s22=var(g22);s31=var(g31);s32=var(g32)
  S1=(s11/n11+s21/n21);S2=(s22/n22+s12/n12)
  S4=(s21/n21+s31/n31);S5=(s22/n22+s32/n32)
  X11=mean(g11);X12=mean(g12);X21=mean(g21);X22=mean(g22)
  X31=mean(g31);X32=mean(g32)
  T11=(X21-X11)/sqrt(S1);T12=(X22-X12)/sqrt(S2)
  T21=(X31-X21)/sqrt(S4);T22=(X32-X22)/sqrt(S5)
  # NNT value
  T.1=min(T11,T21);T.2=min(T12,T22)
  TNN=min(T.1,T.2,na.rm = FALSE)
  out=fun2(n11,n12,n21,n22,n31,n32,s11,s12,s21,s22,s31,s32)
  a=0
  if(TNN>out)
    a=a+1
  return(a)
}
fun4<-function(n11,n12,n21,n22,n31,n32,mu11,mu12,mu21,mu22,mu31,mu32,v11,v12,v21,v22,v31,v32)
{
  # find number of times NNT test statistic value > critical value among 1000 values
  out<-replicate(1000,fun3(n11,n12,n21,n22,n31,n32,mu11,mu12,mu21,mu22,mu31,mu32,v11,v12,v21,v22,v31,v32))
  p<-sum(out)/1000
  return(p)
}

X=replicate(5,fun4(10,15,10,12,14,8,0,0,0,0,0,0,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2,1,2.2,1.3,2.4,1.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*1.5,1.5,2.2*1.5,1.3*1.5,2.4*1.5,1.5*1.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*2,2,2.2*2,1.3*2,2.4*2,1.5*2,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*2.5,2.5,2.2*2.5,1.3*2.5,2.4*2.5,1.5*2.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*3,3,2.2*3,1.3*3,2.4*3,1.5*3,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*3.5,3.5,2.2*3.5,1.3*3.5,2.4*3.5,1.5*3.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*4,4,2.2*4,1.3*4,2.4*4,1.5*4,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*4.5,4.5,2.2*4.5,1.3*4.5,2.4*4.5,1.5*4.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*5,5,2.2*5,1.3*5,2.4*5,1.5*5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*5.5,5.5,2.2*5.5,1.3*5.5,2.4*5.5,1.5*5.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*6,6,2.2*6,1.3*6,2.4*6,1.5*6,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*6.5,6.5,2.2*6.5,1.3*6.5,2.4*6.5,1.5*6.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*7,7,2.2*7,1.3*7,2.4*7,1.5*7,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*7.5,7.5,2.2*7.5,1.3*7.5,2.4*7.5,1.5*7.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*8,8,2.2*8,1.3*8,2.4*8,1.5*8,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*8.5,8.5,2.2*8.5,1.3*8.5,2.4*8.5,1.5*8.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*9,9,2.2*9,1.3*9,2.4*9,1.5*9,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*9.5,9.5,2.2*9.5,1.3*9.5,2.4*9.5,1.5*9.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,15,10,12,14,8,2*10,10,2.2*10,1.3*10,2.4*10,1.5*10,2,4,3,6,4,2))
X;mean(X)




X=replicate(5,fun4(10,25,20,22,24,24,0,0,0,0,0,0,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2,1,2.2,1.3,2.4,1.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*1.5,1.5,2.2*1.5,1.3*1.5,2.4*1.5,1.5*1.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*2,2,2.2*2,1.3*2,2.4*2,1.5*2,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*2.5,2.5,2.2*2.5,1.3*2.5,2.4*2.5,1.5*2.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*3,3,2.2*3,1.3*3,2.4*3,1.5*3,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*3.5,3.5,2.2*3.5,1.3*3.5,2.4*3.5,1.5*3.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*4,4,2.2*4,1.3*4,2.4*4,1.5*4,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*4.5,4.5,2.2*4.5,1.3*4.5,2.4*4.5,1.5*4.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*5,5,2.2*5,1.3*5,2.4*5,1.5*5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*5.5,5.5,2.2*5.5,1.3*5.5,2.4*5.5,1.5*5.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*6,6,2.2*6,1.3*6,2.4*6,1.5*6,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*6.5,6.5,2.2*6.5,1.3*6.5,2.4*6.5,1.5*6.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*7,7,2.2*7,1.3*7,2.4*7,1.5*7,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*7.5,7.5,2.2*7.5,1.3*7.5,2.4*7.5,1.5*7.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*8,8,2.2*8,1.3*8,2.4*8,1.5*8,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*8.5,8.5,2.2*8.5,1.3*8.5,2.4*8.5,1.5*8.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*9,9,2.2*9,1.3*9,2.4*9,1.5*9,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*9.5,9.5,2.2*9.5,1.3*9.5,2.4*9.5,1.5*9.5,2,4,3,6,4,2))
X;mean(X)
X=replicate(5,fun4(10,25,20,22,24,24,2*10,10,2.2*10,1.3*10,2.4*10,1.5*10,2,4,3,6,4,2))
X;mean(X)






X=replicate(5,fun4(5,6,5,6,5,6,0,0,0,0,0,0,4,75,67,53,96,52))
X;mean(X)
X=replicate(5,fun4(8,8,8,8,8,8,0,0,0,0,0,0,4,75,67,53,96,52))
X;mean(X)
X=replicate(5,fun4(15,5,6,10,18,20,0,0,0,0,0,0,4,75,67,53,96,52))
X;mean(X)
X=replicate(5,fun4(10,5,6,60,50,100,0,0,0,0,0,0,4,75,67,53,96,52))
X;mean(X)
X=replicate(5,fun4(5,10,15,20,25,30,0,0,0,0,0,0,4,75,67,53,96,52))
X;mean(X)
X=replicate(5,fun4(30,25,20,15,10,5,0,0,0,0,0,0,4,75,67,53,96,52))
X;mean(X)


X=replicate(5,fun4(5,6,5,6,5,6,0,0,0,0,0,0,52,96,53,67,75,4))
X;mean(X)
X=replicate(5,fun4(8,8,8,8,8,8,0,0,0,0,0,0,52,96,53,67,75,4))
X;mean(X)
X=replicate(5,fun4(15,5,6,10,18,20,0,0,0,0,0,0,52,96,53,67,75,4))
X;mean(X)
X=replicate(5,fun4(10,5,6,60,50,100,0,0,0,0,0,0,52,96,53,67,75,4))
X;mean(X)
X=replicate(5,fun4(5,10,15,20,25,30,0,0,0,0,0,0,52,96,53,67,75,4))
X;mean(X)
X=replicate(5,fun4(30,25,20,15,10,5,0,0,0,0,0,0,52,96,53,67,75,4))
X;mean(X)

X=replicate(5,fun4(5,6,5,6,5,6,0,0,0,0,0,0,10^2,7^2,3^2,2^2,2^2,1))
X;mean(X)
X=replicate(5,fun4(8,8,8,8,8,8,0,0,0,0,0,0,10^2,7^2,3^2,2^2,2^2,1))
X;mean(X)
X=replicate(5,fun4(15,5,6,10,18,20,0,0,0,0,0,0,10^2,7^2,3^2,2^2,2^2,1))
X;mean(X)
X=replicate(5,fun4(10,5,6,60,50,100,0,0,0,0,0,0,10^2,7^2,3^2,2^2,2^2,1))
X;mean(X)
X=replicate(5,fun4(5,10,15,20,25,30,0,0,0,0,0,0,10^2,7^2,3^2,2^2,2^2,1))
X;mean(X)
X=replicate(5,fun4(30,25,20,15,10,5,0,0,0,0,0,0,10^2,7^2,3^2,2^2,2^2,1))
X;mean(X)

X=replicate(5,fun4(5,6,5,6,5,6,0,0,0,0,0,0,1,2^2,2^2,3^2,7^2,10^2))
X;mean(X)
X=replicate(5,fun4(8,8,8,8,8,8,0,0,0,0,0,0,1,2^2,2^2,3^2,7^2,10^2))
X;mean(X)
X=replicate(5,fun4(15,5,6,10,18,20,0,0,0,0,0,0,1,2^2,2^2,3^2,7^2,10^2))
X;mean(X)
X=replicate(5,fun4(10,5,6,60,50,100,0,0,0,0,0,0,1,2^2,2^2,3^2,7^2,10^2))
X;mean(X)
X=replicate(5,fun4(5,10,15,20,25,30,0,0,0,0,0,0,1,2^2,2^2,3^2,7^2,10^2))
X;mean(X)
X=replicate(5,fun4(30,25,20,15,10,5,0,0,0,0,0,0,1,2^2,2^2,3^2,7^2,10^2))
X;mean(X)


