rm(list=ls())
library(Iso)

fun1<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{
  g11<-rnorm(n11,0,sqrt(v11));g12<-rnorm(n12,0,sqrt(v12))
  g13<-rnorm(n13,0,sqrt(v13));g14<-rnorm(n14,0,sqrt(v14))
  g21<-rnorm(n21,0,sqrt(v21));g22<-rnorm(n22,0,sqrt(v22))
  g23<-rnorm(n23,0,sqrt(v23));g24<-rnorm(n24,0,sqrt(v24))
  g31<-rnorm(n31,0,sqrt(v31));g32<-rnorm(n32,0,sqrt(v32))
  g33<-rnorm(n33,0,sqrt(v33));g34<-rnorm(n34,0,sqrt(v34))
  g41<-rnorm(n41,0,sqrt(v41));g42<-rnorm(n42,0,sqrt(v42))
  g43<-rnorm(n43,0,sqrt(v43));g44<-rnorm(n44,0,sqrt(v44))
  g51<-rnorm(n51,0,sqrt(v51));g52<-rnorm(n52,0,sqrt(v52))
  g53<-rnorm(n53,0,sqrt(v53));g54<-rnorm(n54,0,sqrt(v54))
  s11=var(g11);s12=var(g12);s13=var(g13);s14=var(g14)
  s21=var(g21);s22=var(g22);s23=var(g23);s24=var(g24)
  s31=var(g31);s32=var(g32);s33=var(g33);s34=var(g34)
  s41=var(g41);s42=var(g42);s43=var(g43);s44=var(g44)
  s51=var(g51);s52=var(g52);s53=var(g53);s54=var(g54)
  m11=mean(g11);m12=mean(g12);m13=mean(g13);m14=mean(g14)
  m21=mean(g21);m22=mean(g22);m23=mean(g23);m24=mean(g24)
  m31=mean(g31);m32=mean(g32);m33=mean(g33);m34=mean(g34)
  m41=mean(g41);m42=mean(g42);m43=mean(g43);m44=mean(g44)
  m51=mean(g51);m52=mean(g52);m53=mean(g53);m54=mean(g54)
  m.1=(m11+m21+m31+m41+m51)/5;m.2=(m12+m22+m32+m42+m52)/5;m.3=(m13+m23+m33+m43+m53)/5
  m.4=(m14+m24+m34+m44+m54)/5
  m1.=(m11+m12+m13+m14)/4;m2.=(m21+m22+m23+m24)/4;m3.=(m31+m32+m33+m34)/4
  m4.=(m41+m42+m43+m44)/4;m5.=(m51+m52+m53+m54)/4
  m=(m11+m12+m13+m14+m21+m22+m23+m24+m31+m32+m33+m34+m41+m42+m43+m44+m51+m52+m53+m54)/20
  A11=m11-m.1+m;A12=m12-m.2+m;A13=m13-m.3+m;A14=m14-m.4+m
  A21=m21-m.1+m;A22=m22-m.2+m;A23=m23-m.3+m;A24=m24-m.4+m
  A31=m31-m.1+m;A32=m32-m.2+m;A33=m33-m.3+m;A34=m34-m.4+m
  A41=m41-m.1+m;A42=m42-m.2+m;A43=m43-m.3+m;A44=m44-m.4+m
  A51=m51-m.1+m;A52=m52-m.2+m;A53=m53-m.3+m;A54=m54-m.4+m
  x11=c(A11,A21,A31,A41,A51);x12=c(A12,A22,A32,A42,A52);x13=c(A13,A23,A33,A43,A53)
  x14=c(A14,A24,A34,A44,A54);x15=c(m.1-m,m.2-m,m.3-m,m.4-m)
  S11=s11;S12=s12;S13=s13;S14=s14;S21=s21;S22=s22;S23=s23;S24=s24
  S31=s31;S32=s32;S33=s33;S34=s34;S41=s41;S42=s42;S43=s43;S44=s44
  S51=s51;S52=s52;S53=s53;S54=s54
  #sum((g11-x14[1]-x15[1])^2)/n11;S12=sum((g12-x14[1]-x15[2])^2)/n12
  #S21=sum((g21-x14[2]-x15[1])^2)/n21;S22=sum((g22-x14[2]-x15[2])^2)/n22
  repeat
  {
    u11=n11/S11;u12=n12/S12;u13=n13/S13;u14=n14/S14;u21=n21/S21;u22=n22/S22;u23=n23/S23
    u24=n24/S24;u31=n31/S31;u32=n32/S32;u33=n33/S33;u34=n34/S34
    u41=n41/S41;u42=n42/S42;u43=n43/S43;u44=n44/S44
    u51=n51/S51;u52=n52/S52;u53=n53/S53;u54=n54/S54
    u.1=(u11+u21+u31+u41+u51);u.2=(u12+u22+u32+u42+u52);u.3=(u13+u23+u33+u43+u53)
    u.4=(u14+u24+u34+u44+u54)
    a1=c((m11-x15[1]),(m21-x15[1]),(m31-x15[1]),(m41-x15[1]),(m51-x15[1]))
    a2=c((m12-x15[2]),(m22-x15[2]),(m32-x15[2]),(m42-x15[2]),(m52-x15[2]))
    a3=c((m13-x15[3]),(m23-x15[3]),(m33-x15[3]),(m43-x15[3]),(m53-x15[3]))
    a4=c((m14-x15[4]),(m24-x15[4]),(m34-x15[4]),(m44-x15[4]),(m54-x15[4]))
    #a13=((u31*m31+u32*m32)+(u32-u31)*x15[1])/(u31+u32)
    w1=c(u11,u21,u31,u41,u51);w2=c(u12,u22,u32,u42,u52)
    w3=c(u13,u23,u33,u43,u53);w4=c(u14,u24,u34,u44,u54)
    #alpha0<-c(a10,a11,a13)
    #w=c(w1,w2,w3)
    nu1=pava(a1,w1);nu2=pava(a2,w2);nu3=pava(a3,w3);nu4=pava(a4,w4)
    #nu=(nu1[1],nu2[1],nu1[2],nu2[2],nu1[3],nu2[3])
    q=(u14*(m14-nu4[1])+u24*(m24-nu4[2])+u34*(m34-nu4[3])+u44*(m44-nu4[4])+u54*(m54-nu4[5]))
    v1=(u11*(m11-nu1[1])+u21*(m21-nu1[2])+u31*(m31-nu1[3])+u41*(m41-nu1[4])+u51*(m51-nu1[5]))-q
    v2=(u12*(m12-nu2[1])+u22*(m22-nu2[2])+u32*(m32-nu2[3])+u42*(m42-nu2[4])+u52*(m52-nu2[5]))-q
    v3=(u13*(m13-nu3[1])+u23*(m23-nu3[2])+u33*(m33-nu3[3])+u43*(m43-nu3[4])+u53*(m53-nu3[5]))-q
    v=matrix(c(v1,v2,v3),nrow=3,ncol=1,byrow=TRUE)
    A=matrix(c(u.1+u.4,u.4,u.4,u.4,u.2+u.4,u.4,u.4,u.4,u.4+u.3),nrow=3,ncol=3,byrow=TRUE)
    b=solve(A)%*%v
    b4=-(b[1]+b[2]+b[3])
    beta=c(b[1],b[2],b[3],b4)
    S111=sum((g11-nu1[1]-b[1])^2)/n11;S112=sum((g12-nu2[1]-b[2])^2)/n12
    S113=sum((g13-nu3[1]-b[3])^2)/n13;S114=sum((g14-nu4[1]-b4)^2)/n14
    S121=sum((g21-nu1[2]-b[1])^2)/n21;S122=sum((g22-nu2[2]-b[2])^2)/n22
    S123=sum((g23-nu3[2]-b[3])^2)/n23;S124=sum((g24-nu4[2]-b4)^2)/n24
    S131=sum((g31-nu1[3]-b[1])^2)/n31;S132=sum((g32-nu2[3]-b[2])^2)/n32
    S133=sum((g33-nu3[3]-b[3])^2)/n33;S134=sum((g34-nu4[3]-b4)^2)/n34
    S141=sum((g41-nu1[4]-b[1])^2)/n41;S142=sum((g42-nu2[4]-b[2])^2)/n42
    S143=sum((g43-nu3[4]-b[3])^2)/n43;S144=sum((g44-nu4[4]-b4)^2)/n44
    S151=sum((g51-nu1[5]-b[1])^2)/n51;S152=sum((g52-nu2[5]-b[2])^2)/n52
    S153=sum((g53-nu3[5]-b[3])^2)/n53;S154=sum((g54-nu4[5]-b4)^2)/n54
    L=max(abs(x11-nu1));M=max(abs(x12-nu2));N=max(abs(x13-nu3));O=max(abs(x14-nu4))
    P=max(abs(x15-beta))
    if(L<=0.000001 & M<=0.0000001 & N<=0.0000001 & 0<=0.000001 & P<=0.000001)
    {
      break
    }
    S11=S111;S12=S112;S13=S113;S14=S114;S21=S121;S22=S122;S23=S123;S24=S124
    S31=S131;S32=S132;S33=S133;S34=S134;S41=S141;S42=S142;S43=S143;S44=S144
    S51=S151;S52=S152;S53=S153;S54=S154
    x11=nu1;x12=nu2;x13=nu3;x14=nu4;x15=beta
  }
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u14=n14/s14;u21=n21/s21;u22=n22/s22;u23=n23/s23
  u24=n24/s24;u31=n31/s31;u32=n32/s32;u33=n33/s33;u34=n34/s34
  u41=n41/s41;u42=n42/s42;u43=n43/s43;u44=n44/s44
  u51=n51/s51;u52=n52/s52;u53=n53/s53;u54=n54/s54
  U.1=u11+u21+u31+u41+u51;U.2=u12+u22+u32+u42+u52;U.3=u13+u23+u33+u43+u53
  U.4=u14+u24+u34+u44+u54
  beta01=c((u11*m11+u21*m21+u31*m31+u41*m41+u51*m51)/U.1,
           (u12*m12+u22*m22+u32*m32+u42*m42+u52*m52)/U.2,
          (u13*m13+u23*m23+u33*m33+u43*m43+u53*m53)/U.3,
          (u14*m14+u24*m24+u34*m34+u44*m44+u54*m54)/U.4)
  x16=beta01
  V11=sum((g11-x16[1])^2)/n11;V12=sum((g12-x16[2])^2)/n12
  V13=sum((g13-x16[3])^2)/n13;V14=sum((g14-x16[4])^2)/n14
  V21=sum((g21-x16[1])^2)/n21;V22=sum((g22-x16[2])^2)/n22
  V23=sum((g23-x16[3])^2)/n23;V24=sum((g24-x16[4])^2)/n24
  V31=sum((g31-x16[1])^2)/n31;V32=sum((g32-x16[2])^2)/n32
  V33=sum((g33-x16[3])^2)/n33;V34=sum((g34-x16[4])^2)/n34
  V41=sum((g41-x16[1])^2)/n41;V42=sum((g42-x16[2])^2)/n42
  V43=sum((g43-x16[3])^2)/n43;V44=sum((g44-x16[4])^2)/n44
  V51=sum((g51-x16[1])^2)/n51;V52=sum((g52-x16[2])^2)/n52
  V53=sum((g53-x16[3])^2)/n53;V54=sum((g54-x16[4])^2)/n54
  repeat
  {
    u11=n11/V11;u12=n12/V12;u13=n13/V13;u14=n14/V14;u21=n21/V21;u22=n22/V22;u23=n23/V23
    u24=n24/V24;u31=n31/V31;u32=n32/V32;u33=n33/V33;u34=n34/V34
    u41=n41/V41;u42=n42/V42;u43=n43/V43;u44=n44/V44
    u51=n51/V51;u52=n52/V52;u53=n53/V53;u54=n54/V54
    U.1=u11+u21+u31+u41+u51;U.2=u12+u22+u32+u42+u52;U.3=u13+u23+u33+u43+u53
    U.4=u14+u24+u34+u44+u54
    beta11=c((u11*m11+u21*m21+u31*m31+u41*m41+u51*m51)/U.1,
             (u12*m12+u22*m22+u32*m32+u42*m42+u52*m52)/U.2,
             (u13*m13+u23*m23+u33*m33+u43*m43+u53*m53)/U.3,
             (u14*m14+u24*m24+u34*m34+u44*m44+u54*m54)/U.4)
    dif=max(abs(x16-beta11))
    if(dif<=0.00001)
    {
      break
    }
    S011=sum((g11-beta11[1])^2)/n11;S012=sum((g12-beta11[2])^2)/n12
    S013=sum((g13-beta11[3])^2)/n13;S014=sum((g14-beta11[4])^2)/n14
    S021=sum((g21-beta11[1])^2)/n21;S022=sum((g22-beta11[2])^2)/n22
    S023=sum((g23-beta11[3])^2)/n23;S024=sum((g24-beta11[4])^2)/n24
    S031=sum((g31-beta11[1])^2)/n31;S032=sum((g32-beta11[2])^2)/n32
    S033=sum((g33-beta11[3])^2)/n33;S034=sum((g34-beta11[4])^2)/n34
    S041=sum((g41-beta11[1])^2)/n41;S042=sum((g42-beta11[2])^2)/n42
    S043=sum((g43-beta11[3])^2)/n43;S044=sum((g44-beta11[4])^2)/n44
    S051=sum((g51-beta11[1])^2)/n51;S052=sum((g52-beta11[2])^2)/n52
    S053=sum((g53-beta11[3])^2)/n53;S054=sum((g54-beta11[4])^2)/n54
    V11=S011;V12=S012;V13=S013;V14=S014;V21=S021;V22=S022;V23=S023;V24=S024
    V31=S031;V32=S032;V33=S033;V34=S034;V41=S041;V42=S042;V43=S043;V44=S044
    V51=S051;V52=S052;V53=S053;V54=S054
    x16=beta11
  }
  neu=(S111^(n11/2))*(S112^(n12/2))*(S113^(n13/2))*(S114^(n14/2))*(S121^(n21/2))*(S122^(n22/2))*(S123^(n23/2))*(S124^(n24/2))*
    (S131^(n31/2))*(S132^(n32/2))*(S133^(n33/2))*(S134^(n34/2))*(S141^(n41/2))*(S142^(n42/2))*(S143^(n43/2))*(S144^(n44/2))*
    (S151^(n51/2))*(S152^(n52/2))*(S153^(n53/2))*(S154^(n54/2))
  dno=(V11^(n11/2))*(V12^(n12/2))*(V13^(n13/2))*(V14^(n14/2))*(V21^(n21/2))*(V22^(n22/2))*(V23^(n23/2))*(V24^(n24/2))*
    (V31^(n31/2))*(V32^(n32/2))*(V33^(n33/2))*(V34^(n34/2))*(V41^(n41/2))*(V42^(n42/2))*(V43^(n43/2))*(V44^(n44/2))*
    (V51^(n51/2))*(V52^(n52/2))*(V53^(n53/2))*(V54^(n54/2))
  value=neu/dno
  return(value)
}
#X=replicate(10000,fun1(10,10,10,15,15,10,10,14,15,10,14,10,20,25,20,20,40,30,20,20,
#                       1,1,2,3,4,1,1,2,2,3,3,5,3,1,5,2,1,2,3,1))
#plot(X)

fun2<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{
  x=replicate(1000,fun1(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
                        v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54))
  y<-sort(x,decreasing=FALSE)
  c<-y[50]
  return(c)
}
fun3<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,mu41,mu42,mu43,mu44,
               mu51,mu52,mu53,mu54,v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,
               v44,v51,v52,v53,v54)
{
  g11<-rnorm(n11,mu11,sqrt(v11));g12<-rnorm(n12,mu12,sqrt(v12))
  g13<-rnorm(n13,mu13,sqrt(v13));g14<-rnorm(n14,mu14,sqrt(v14))
  g21<-rnorm(n21,mu21,sqrt(v21));g22<-rnorm(n22,mu22,sqrt(v22))
  g23<-rnorm(n23,mu23,sqrt(v23));g24<-rnorm(n24,mu24,sqrt(v24))
  g31<-rnorm(n31,mu31,sqrt(v31));g32<-rnorm(n32,mu32,sqrt(v32))
  g33<-rnorm(n33,mu33,sqrt(v33));g34<-rnorm(n34,mu34,sqrt(v34))
  g41<-rnorm(n41,mu41,sqrt(v41));g42<-rnorm(n42,mu42,sqrt(v42))
  g43<-rnorm(n43,mu43,sqrt(v43));g44<-rnorm(n44,mu44,sqrt(v44))
  g51<-rnorm(n51,mu51,sqrt(v51));g52<-rnorm(n52,mu52,sqrt(v52))
  g53<-rnorm(n53,mu53,sqrt(v53));g54<-rnorm(n54,mu54,sqrt(v54))
  s11=var(g11);s12=var(g12);s13=var(g13);s14=var(g14)
  s21=var(g21);s22=var(g22);s23=var(g23);s24=var(g24)
  s31=var(g31);s32=var(g32);s33=var(g33);s34=var(g34)
  s41=var(g41);s42=var(g42);s43=var(g43);s44=var(g44)
  s51=var(g51);s52=var(g52);s53=var(g53);s54=var(g54)
  m11=mean(g11);m12=mean(g12);m13=mean(g13);m14=mean(g14)
  m21=mean(g21);m22=mean(g22);m23=mean(g23);m24=mean(g24)
  m31=mean(g31);m32=mean(g32);m33=mean(g33);m34=mean(g34)
  m41=mean(g41);m42=mean(g42);m43=mean(g43);m44=mean(g44)
  m51=mean(g51);m52=mean(g52);m53=mean(g53);m54=mean(g54)
  m.1=(m11+m21+m31+m41+m51)/5;m.2=(m12+m22+m32+m42+m52)/5;m.3=(m13+m23+m33+m43+m53)/5
  m.4=(m14+m24+m34+m44+m54)/5
  m1.=(m11+m12+m13+m14)/4;m2.=(m21+m22+m23+m24)/4;m3.=(m31+m32+m33+m34)/4
  m4.=(m41+m42+m43+m44)/4;m5.=(m51+m52+m53+m54)/4
  m=(m11+m12+m13+m14+m21+m22+m23+m24+m31+m32+m33+m34+m41+m42+m43+m44+m51+m52+m53+m54)/20
  A11=m11-m.1+m;A12=m12-m.2+m;A13=m13-m.3+m;A14=m14-m.4+m
  A21=m21-m.1+m;A22=m22-m.2+m;A23=m23-m.3+m;A24=m24-m.4+m
  A31=m31-m.1+m;A32=m32-m.2+m;A33=m33-m.3+m;A34=m34-m.4+m
  A41=m41-m.1+m;A42=m42-m.2+m;A43=m43-m.3+m;A44=m44-m.4+m
  A51=m51-m.1+m;A52=m52-m.2+m;A53=m53-m.3+m;A54=m54-m.4+m
  x11=c(A11,A21,A31,A41,A51);x12=c(A12,A22,A32,A42,A52);x13=c(A13,A23,A33,A43,A53)
  x14=c(A14,A24,A34,A44,A54);x15=c(m.1-m,m.2-m,m.3-m,m.4-m)
  S11=s11;S12=s12;S13=s13;S14=s14;S21=s21;S22=s22;S23=s23;S24=s24
  S31=s31;S32=s32;S33=s33;S34=s34;S41=s41;S42=s42;S43=s43;S44=s44
  S51=s51;S52=s52;S53=s53;S54=s54
  #sum((g11-x14[1]-x15[1])^2)/n11;S12=sum((g12-x14[1]-x15[2])^2)/n12
  #S21=sum((g21-x14[2]-x15[1])^2)/n21;S22=sum((g22-x14[2]-x15[2])^2)/n22
  repeat
  {
    u11=n11/S11;u12=n12/S12;u13=n13/S13;u14=n14/S14;u21=n21/S21;u22=n22/S22;u23=n23/S23
    u24=n24/S24;u31=n31/S31;u32=n32/S32;u33=n33/S33;u34=n34/S34
    u41=n41/S41;u42=n42/S42;u43=n43/S43;u44=n44/S44
    u51=n51/S51;u52=n52/S52;u53=n53/S53;u54=n54/S54
    u.1=(u11+u21+u31+u41+u51);u.2=(u12+u22+u32+u42+u52);u.3=(u13+u23+u33+u43+u53)
    u.4=(u14+u24+u34+u44+u54)
    a1=c((m11-x15[1]),(m21-x15[1]),(m31-x15[1]),(m41-x15[1]),(m51-x15[1]))
    a2=c((m12-x15[2]),(m22-x15[2]),(m32-x15[2]),(m42-x15[2]),(m52-x15[2]))
    a3=c((m13-x15[3]),(m23-x15[3]),(m33-x15[3]),(m43-x15[3]),(m53-x15[3]))
    a4=c((m14-x15[4]),(m24-x15[4]),(m34-x15[4]),(m44-x15[4]),(m54-x15[4]))
    #a13=((u31*m31+u32*m32)+(u32-u31)*x15[1])/(u31+u32)
    w1=c(u11,u21,u31,u41,u51);w2=c(u12,u22,u32,u42,u52)
    w3=c(u13,u23,u33,u43,u53);w4=c(u14,u24,u34,u44,u54)
    #alpha0<-c(a10,a11,a13)
    #w=c(w1,w2,w3)
    nu1=pava(a1,w1);nu2=pava(a2,w2);nu3=pava(a3,w3);nu4=pava(a4,w4)
    #nu=(nu1[1],nu2[1],nu1[2],nu2[2],nu1[3],nu2[3])
    q=(u14*(m14-nu4[1])+u24*(m24-nu4[2])+u34*(m34-nu4[3])+u44*(m44-nu4[4])+u54*(m54-nu4[5]))
    v1=(u11*(m11-nu1[1])+u21*(m21-nu1[2])+u31*(m31-nu1[3])+u41*(m41-nu1[4])+u51*(m51-nu1[5]))-q
    v2=(u12*(m12-nu2[1])+u22*(m22-nu2[2])+u32*(m32-nu2[3])+u42*(m42-nu2[4])+u52*(m52-nu2[5]))-q
    v3=(u13*(m13-nu3[1])+u23*(m23-nu3[2])+u33*(m33-nu3[3])+u43*(m43-nu3[4])+u53*(m53-nu3[5]))-q
    v=matrix(c(v1,v2,v3),nrow=3,ncol=1,byrow=TRUE)
    A=matrix(c(u.1+u.4,u.4,u.4,u.4,u.2+u.4,u.4,u.4,u.4,u.4+u.3),nrow=3,ncol=3,byrow=TRUE)
    b=solve(A)%*%v
    b4=-(b[1]+b[2]+b[3])
    beta=c(b[1],b[2],b[3],b4)
    S111=sum((g11-nu1[1]-b[1])^2)/n11;S112=sum((g12-nu2[1]-b[2])^2)/n12
    S113=sum((g13-nu3[1]-b[3])^2)/n13;S114=sum((g14-nu4[1]-b4)^2)/n14
    S121=sum((g21-nu1[2]-b[1])^2)/n21;S122=sum((g22-nu2[2]-b[2])^2)/n22
    S123=sum((g23-nu3[2]-b[3])^2)/n23;S124=sum((g24-nu4[2]-b4)^2)/n24
    S131=sum((g31-nu1[3]-b[1])^2)/n31;S132=sum((g32-nu2[3]-b[2])^2)/n32
    S133=sum((g33-nu3[3]-b[3])^2)/n33;S134=sum((g34-nu4[3]-b4)^2)/n34
    S141=sum((g41-nu1[4]-b[1])^2)/n41;S142=sum((g42-nu2[4]-b[2])^2)/n42
    S143=sum((g43-nu3[4]-b[3])^2)/n43;S144=sum((g44-nu4[4]-b4)^2)/n44
    S151=sum((g51-nu1[5]-b[1])^2)/n51;S152=sum((g52-nu2[5]-b[2])^2)/n52
    S153=sum((g53-nu3[5]-b[3])^2)/n53;S154=sum((g54-nu4[5]-b4)^2)/n54
    L=max(abs(x11-nu1));M=max(abs(x12-nu2));N=max(abs(x13-nu3));O=max(abs(x14-nu4))
    P=max(abs(x15-beta))
    if(L<=0.000001 & M<=0.0000001 & N<=0.0000001 & 0<=0.000001 & P<=0.000001)
    {
      break
    }
    S11=S111;S12=S112;S13=S113;S14=S114;S21=S121;S22=S122;S23=S123;S24=S124
    S31=S131;S32=S132;S33=S133;S34=S134;S41=S141;S42=S142;S43=S143;S44=S144
    S51=S151;S52=S152;S53=S153;S54=S154
    x11=nu1;x12=nu2;x13=nu3;x14=nu4;x15=beta
  }
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u14=n14/s14;u21=n21/s21;u22=n22/s22;u23=n23/s23
  u24=n24/s24;u31=n31/s31;u32=n32/s32;u33=n33/s33;u34=n34/s34
  u41=n41/s41;u42=n42/s42;u43=n43/s43;u44=n44/s44
  u51=n51/s51;u52=n52/s52;u53=n53/s53;u54=n54/s54
  U.1=u11+u21+u31+u41+u51;U.2=u12+u22+u32+u42+u52;U.3=u13+u23+u33+u43+u53
  U.4=u14+u24+u34+u44+u54
  beta01=c((u11*m11+u21*m21+u31*m31+u41*m41+u51*m51)/U.1,
           (u12*m12+u22*m22+u32*m32+u42*m42+u52*m52)/U.2,
           (u13*m13+u23*m23+u33*m33+u43*m43+u53*m53)/U.3,
           (u14*m14+u24*m24+u34*m34+u44*m44+u54*m54)/U.4)
  x16=beta01
  V11=sum((g11-x16[1])^2)/n11;V12=sum((g12-x16[2])^2)/n12
  V13=sum((g13-x16[3])^2)/n13;V14=sum((g14-x16[4])^2)/n14
  V21=sum((g21-x16[1])^2)/n21;V22=sum((g22-x16[2])^2)/n22
  V23=sum((g23-x16[3])^2)/n23;V24=sum((g24-x16[4])^2)/n24
  V31=sum((g31-x16[1])^2)/n31;V32=sum((g32-x16[2])^2)/n32
  V33=sum((g33-x16[3])^2)/n33;V34=sum((g34-x16[4])^2)/n34
  V41=sum((g41-x16[1])^2)/n41;V42=sum((g42-x16[2])^2)/n42
  V43=sum((g43-x16[3])^2)/n43;V44=sum((g44-x16[4])^2)/n44
  V51=sum((g51-x16[1])^2)/n51;V52=sum((g52-x16[2])^2)/n52
  V53=sum((g53-x16[3])^2)/n53;V54=sum((g54-x16[4])^2)/n54
  repeat
  {
    u11=n11/V11;u12=n12/V12;u13=n13/V13;u14=n14/V14;u21=n21/V21;u22=n22/V22;u23=n23/V23
    u24=n24/V24;u31=n31/V31;u32=n32/V32;u33=n33/V33;u34=n34/V34
    u41=n41/V41;u42=n42/V42;u43=n43/V43;u44=n44/V44
    u51=n51/V51;u52=n52/V52;u53=n53/V53;u54=n54/V54
    U.1=u11+u21+u31+u41+u51;U.2=u12+u22+u32+u42+u52;U.3=u13+u23+u33+u43+u53
    U.4=u14+u24+u34+u44+u54
    beta11=c((u11*m11+u21*m21+u31*m31+u41*m41+u51*m51)/U.1,
             (u12*m12+u22*m22+u32*m32+u42*m42+u52*m52)/U.2,
             (u13*m13+u23*m23+u33*m33+u43*m43+u53*m53)/U.3,
             (u14*m14+u24*m24+u34*m34+u44*m44+u54*m54)/U.4)
    dif=max(abs(x16-beta11))
    if(dif<=0.00001)
    {
      break
    }
    S011=sum((g11-beta11[1])^2)/n11;S012=sum((g12-beta11[2])^2)/n12
    S013=sum((g13-beta11[3])^2)/n13;S014=sum((g14-beta11[4])^2)/n14
    S021=sum((g21-beta11[1])^2)/n21;S022=sum((g22-beta11[2])^2)/n22
    S023=sum((g23-beta11[3])^2)/n23;S024=sum((g24-beta11[4])^2)/n24
    S031=sum((g31-beta11[1])^2)/n31;S032=sum((g32-beta11[2])^2)/n32
    S033=sum((g33-beta11[3])^2)/n33;S034=sum((g34-beta11[4])^2)/n34
    S041=sum((g41-beta11[1])^2)/n41;S042=sum((g42-beta11[2])^2)/n42
    S043=sum((g43-beta11[3])^2)/n43;S044=sum((g44-beta11[4])^2)/n44
    S051=sum((g51-beta11[1])^2)/n51;S052=sum((g52-beta11[2])^2)/n52
    S053=sum((g53-beta11[3])^2)/n53;S054=sum((g54-beta11[4])^2)/n54
    V11=S011;V12=S012;V13=S013;V14=S014;V21=S021;V22=S022;V23=S023;V24=S024
    V31=S031;V32=S032;V33=S033;V34=S034;V41=S041;V42=S042;V43=S043;V44=S044
    V51=S051;V52=S052;V53=S053;V54=S054
    x16=beta11
  }
  neu=(S111^(n11/2))*(S112^(n12/2))*(S113^(n13/2))*(S114^(n14/2))*(S121^(n21/2))*(S122^(n22/2))*(S123^(n23/2))*(S124^(n24/2))*
    (S131^(n31/2))*(S132^(n32/2))*(S133^(n33/2))*(S134^(n34/2))*(S141^(n41/2))*(S142^(n42/2))*(S143^(n43/2))*(S144^(n44/2))*
    (S151^(n51/2))*(S152^(n52/2))*(S153^(n53/2))*(S154^(n54/2))
  dno=(V11^(n11/2))*(V12^(n12/2))*(V13^(n13/2))*(V14^(n14/2))*(V21^(n21/2))*(V22^(n22/2))*(V23^(n23/2))*(V24^(n24/2))*
    (V31^(n31/2))*(V32^(n32/2))*(V33^(n33/2))*(V34^(n34/2))*(V41^(n41/2))*(V42^(n42/2))*(V43^(n43/2))*(V44^(n44/2))*
    (V51^(n51/2))*(V52^(n52/2))*(V53^(n53/2))*(V54^(n54/2))
  value=neu/dno
  #return(value)
  out<-fun2(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
            s11,s12,s13,s14,s21,s22,s23,s24,s31,s32,s33,s34,s41,s42,s43,s44,s51,s52,s53,s54)
  a=0
  if(value<out)
    a=a+1
  return(a)
}
fun4<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,mu41,mu42,mu43,mu44,
               mu51,mu52,mu53,mu54,v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,
               v44,v51,v52,v53,v54)
{
  # find number of times LRT test statistic value < critical value among 1000 values
  out<-replicate(1000,fun3(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
                           mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,mu41,mu42,mu43,mu44,
                           mu51,mu52,mu53,mu54,v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,
                           v44,v51,v52,v53,v54))
  value<-mean(out)
  return(value)
}

X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*1.5,0.1*1.5,0.1*1.5,0.1*1.5,0.2*1.5,0.2*1.5,0.2*1.5,0.2*1.5,0.3*1.5,0.3*1.5,
                   0.3*1.5,0.3*1.5,0.4*1.5,0.4*1.5,0.4*1.5,0.4*1.5,0.5*1.5,0.5*1.5,0.5*1.5,0.5*1.5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*2,0.1*2,0.1*2,0.1*2,0.2*2,0.2*2,0.2*2,0.2*2,0.3*2,0.3*2,
                   0.3*2,0.3*2,0.4*2,0.4*2,0.4*2,0.4*2,0.5*2,0.5*2,0.5*2,0.5*2,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*2.5,0.1*2.5,0.1*2.5,0.1*2.5,0.2*2.5,0.2*2.5,0.2*2.5,0.2*2.5,0.3*2.5,0.3*2.5,
                   0.3*2.5,0.3*2.5,0.4*2.5,0.4*2.5,0.4*2.5,0.4*2.5,0.5*2.5,0.5*2.5,0.5*2.5,0.5*2.5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*3,0.1*3,0.1*3,0.1*3,0.2*3,0.2*3,0.2*3,0.2*3,0.3*3,0.3*3,
                   0.3*3,0.3*3,0.4*3,0.4*3,0.4*3,0.4*3,0.5*3,0.5*3,0.5*3,0.5*3,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*3.5,0.1*3.5,0.1*3.5,0.1*3.5,0.2*3.5,0.2*3.5,0.2*3.5,0.2*3.5,0.3*3.5,0.3*3.5,
                   0.3*3.5,0.3*3.5,0.4*3.5,0.4*3.5,0.4*3.5,0.4*3.5,0.5*3.5,0.5*3.5,0.5*3.5,0.5*3.5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*4,0.1*4,0.1*4,0.1*4,0.2*4,0.2*4,0.2*4,0.2*4,0.3*4,0.3*4,
                   0.3*4,0.3*4,0.4*4,0.4*4,0.4*4,0.4*4,0.5*4,0.5*4,0.5*4,0.5*4,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*4.5,0.1*4.5,0.1*4.5,0.1*4.5,0.2*4.5,0.2*4.5,0.2*4.5,0.2*4.5,0.3*4.5,0.3*4.5,
                   0.3*4.5,0.3*4.5,0.4*4.5,0.4*4.5,0.4*4.5,0.4*4.5,0.5*4.5,0.5*4.5,0.5*4.5,0.5*4.5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*5,0.1*5,0.1*5,0.1*5,0.2*5,0.2*5,0.2*5,0.2*5,0.3*5,0.3*5,
                   0.3*5,0.3*5,0.4*5,0.4*5,0.4*5,0.4*5,0.5*5,0.5*5,0.5*5,0.5*5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*5.5,0.1*5.5,0.1*5.5,0.1*5.5,0.2*5.5,0.2*5.5,0.2*5.5,0.2*5.5,0.3*5.5,0.3*5.5,
                   0.3*5.5,0.3*5.5,0.4*5.5,0.4*5.5,0.4*5.5,0.4*5.5,0.5*5.5,0.5*5.5,0.5*5.5,0.5*5.5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*6,0.1*6,0.1*6,0.1*6,0.2*6,0.2*6,0.2*6,0.2*6,0.3*6,0.3*6,
                   0.3*6,0.3*6,0.4*6,0.4*6,0.4*6,0.4*6,0.5*6,0.5*6,0.5*6,0.5*6,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*6.5,0.1*6.5,0.1*6.5,0.1*6.5,0.2*6.5,0.2*6.5,0.2*6.5,0.2*6.5,0.3*6.5,0.3*6.5,
                   0.3*6.5,0.3*6.5,0.4*6.5,0.4*6.5,0.4*6.5,0.4*6.5,0.5*6.5,0.5*6.5,0.5*6.5,0.5*6.5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*7,0.1*7,0.1*7,0.1*7,0.2*7,0.2*7,0.2*7,0.2*7,0.3*7,0.3*7,
                   0.3*7,0.3*7,0.4*7,0.4*7,0.4*7,0.4*7,0.5*7,0.5*7,0.5*7,0.5*7,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*7.5,0.1*7.5,0.1*7.5,0.1*7.5,0.2*7.5,0.2*7.5,0.2*7.5,0.2*7.5,0.3*7.5,0.3*7.5,
                   0.3*7.5,0.3*7.5,0.4*7.5,0.4*7.5,0.4*7.5,0.4*7.5,0.5*7.5,0.5*7.5,0.5*7.5,0.5*7.5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*8,0.1*8,0.1*8,0.1*8,0.2*8,0.2*8,0.2*8,0.2*8,0.3*8,0.3*8,
                   0.3*8,0.3*8,0.4*8,0.4*8,0.4*8,0.4*8,0.5*8,0.5*8,0.5*8,0.5*8,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*8.5,0.1*8.5,0.1*8.5,0.1*8.5,0.2*8.5,0.2*8.5,0.2*8.5,0.2*8.5,0.3*8.5,0.3*8.5,
                   0.3*8.5,0.3*8.5,0.4*8.5,0.4*8.5,0.4*8.5,0.4*8.5,0.5*8.5,0.5*8.5,0.5*8.5,0.5*8.5,
                   16,9,4,4,1,16,9,4,4,1,16,9,4,4,1,16,9,4,4,1))
mean(X)






X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*1.5,0.1*1.5,0.1*1.5,0.1*1.5,0.2*1.5,0.2*1.5,0.2*1.5,0.2*1.5,0.3*1.5,0.3*1.5,
                   0.3*1.5,0.3*1.5,0.4*1.5,0.4*1.5,0.4*1.5,0.4*1.5,0.5*1.5,0.5*1.5,0.5*1.5,0.5*1.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*2,0.1*2,0.1*2,0.1*2,0.2*2,0.2*2,0.2*2,0.2*2,0.3*2,0.3*2,
                   0.3*2,0.3*2,0.4*2,0.4*2,0.4*2,0.4*2,0.5*2,0.5*2,0.5*2,0.5*2,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*2.5,0.1*2.5,0.1*2.5,0.1*2.5,0.2*2.5,0.2*2.5,0.2*2.5,0.2*2.5,0.3*2.5,0.3*2.5,
                   0.3*2.5,0.3*2.5,0.4*2.5,0.4*2.5,0.4*2.5,0.4*2.5,0.5*2.5,0.5*2.5,0.5*2.5,0.5*2.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*3,0.1*3,0.1*3,0.1*3,0.2*3,0.2*3,0.2*3,0.2*3,0.3*3,0.3*3,
                   0.3*3,0.3*3,0.4*3,0.4*3,0.4*3,0.4*3,0.5*3,0.5*3,0.5*3,0.5*3,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*3.5,0.1*3.5,0.1*3.5,0.1*3.5,0.2*3.5,0.2*3.5,0.2*3.5,0.2*3.5,0.3*3.5,0.3*3.5,
                   0.3*3.5,0.3*3.5,0.4*3.5,0.4*3.5,0.4*3.5,0.4*3.5,0.5*3.5,0.5*3.5,0.5*3.5,0.5*3.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*4,0.1*4,0.1*4,0.1*4,0.2*4,0.2*4,0.2*4,0.2*4,0.3*4,0.3*4,
                   0.3*4,0.3*4,0.4*4,0.4*4,0.4*4,0.4*4,0.5*4,0.5*4,0.5*4,0.5*4,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*4.5,0.1*4.5,0.1*4.5,0.1*4.5,0.2*4.5,0.2*4.5,0.2*4.5,0.2*4.5,0.3*4.5,0.3*4.5,
                   0.3*4.5,0.3*4.5,0.4*4.5,0.4*4.5,0.4*4.5,0.4*4.5,0.5*4.5,0.5*4.5,0.5*4.5,0.5*4.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*5,0.1*5,0.1*5,0.1*5,0.2*5,0.2*5,0.2*5,0.2*5,0.3*5,0.3*5,
                   0.3*5,0.3*5,0.4*5,0.4*5,0.4*5,0.4*5,0.5*5,0.5*5,0.5*5,0.5*5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*5.5,0.1*5.5,0.1*5.5,0.1*5.5,0.2*5.5,0.2*5.5,0.2*5.5,0.2*5.5,0.3*5.5,0.3*5.5,
                   0.3*5.5,0.3*5.5,0.4*5.5,0.4*5.5,0.4*5.5,0.4*5.5,0.5*5.5,0.5*5.5,0.5*5.5,0.5*5.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*6,0.1*6,0.1*6,0.1*6,0.2*6,0.2*6,0.2*6,0.2*6,0.3*6,0.3*6,
                   0.3*6,0.3*6,0.4*6,0.4*6,0.4*6,0.4*6,0.5*6,0.5*6,0.5*6,0.5*6,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*6.5,0.1*6.5,0.1*6.5,0.1*6.5,0.2*6.5,0.2*6.5,0.2*6.5,0.2*6.5,0.3*6.5,0.3*6.5,
                   0.3*6.5,0.3*6.5,0.4*6.5,0.4*6.5,0.4*6.5,0.4*6.5,0.5*6.5,0.5*6.5,0.5*6.5,0.5*6.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*7,0.1*7,0.1*7,0.1*7,0.2*7,0.2*7,0.2*7,0.2*7,0.3*7,0.3*7,
                   0.3*7,0.3*7,0.4*7,0.4*7,0.4*7,0.4*7,0.5*7,0.5*7,0.5*7,0.5*7,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*7.5,0.1*7.5,0.1*7.5,0.1*7.5,0.2*7.5,0.2*7.5,0.2*7.5,0.2*7.5,0.3*7.5,0.3*7.5,
                   0.3*7.5,0.3*7.5,0.4*7.5,0.4*7.5,0.4*7.5,0.4*7.5,0.5*7.5,0.5*7.5,0.5*7.5,0.5*7.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*8,0.1*8,0.1*8,0.1*8,0.2*8,0.2*8,0.2*8,0.2*8,0.3*8,0.3*8,
                   0.3*8,0.3*8,0.4*8,0.4*8,0.4*8,0.4*8,0.5*8,0.5*8,0.5*8,0.5*8,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*8.5,0.1*8.5,0.1*8.5,0.1*8.5,0.2*8.5,0.2*8.5,0.2*8.5,0.2*8.5,0.3*8.5,0.3*8.5,
                   0.3*8.5,0.3*8.5,0.4*8.5,0.4*8.5,0.4*8.5,0.4*8.5,0.5*8.5,0.5*8.5,0.5*8.5,0.5*8.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*9,0.1*9,0.1*9,0.1*9,0.2*9,0.2*9,0.2*9,0.2*9,0.3*9,0.3*9,
                   0.3*9,0.3*9,0.4*9,0.4*9,0.4*9,0.4*9,0.5*9,0.5*9,0.5*9,0.5*9,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*9.5,0.1*9.5,0.1*9.5,0.1*9.5,0.2*9.5,0.2*9.5,0.2*9.5,0.2*9.5,0.3*9.5,0.3*9.5,
                   0.3*9.5,0.3*9.5,0.4*9.5,0.4*9.5,0.4*9.5,0.4*9.5,0.5*9.5,0.5*9.5,0.5*9.5,0.5*9.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*10,0.1*10,0.1*10,0.1*10,0.2*10,0.2*10,0.2*10,0.2*10,0.3*10,0.3*10,
                   0.3*10,0.3*10,0.4*10,0.4*10,0.4*10,0.4*10,0.5*10,0.5*10,0.5*10,0.5*10,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*10.5,0.1*10.5,0.1*10.5,0.1*10.5,0.2*10.5,0.2*10.5,0.2*10.5,0.2*10.5,0.3*10.5,
                   0.3*10.5,0.3*10.5,0.3*10.5,0.4*10.5,0.4*10.5,0.4*10.5,0.4*10.5,0.5*10.5,0.5*10.5,0.5*10.5,0.5*10.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*11,0.1*11,0.1*11,0.1*11,0.2*11,0.2*11,0.2*11,0.2*11,0.3*11,0.3*11,
                   0.3*11,0.3*11,0.4*11,0.4*11,0.4*11,0.4*11,0.5*11,0.5*11,0.5*11,0.5*11,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)






X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,4,5,
                   6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4,-0.2,-1.05,0.2,-0.3,-0.1,-1.02,-0.1,-0.2,-0.05,-1,0,0.3,0.25,1.07,0.1,0.4,0.1,
                   2,0.2,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*1.5,-0.2*1.5,-1.05*1.5,0.2*1.5,-0.3*1.5,-0.1*1.5,-1.02*1.5,-0.1*1.5,-0.2*1.5,
                   -0.05*1.5,-1*1.5,0,0.3*1.5,0.25*1.5,1.07*1.5,0.1*1.5,0.4*1.5,0.1*1.5,
                   2*1.5,0.2*1.5,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*2,-0.2*2,-1.05*2,0.2*2,-0.3*2,-0.1*2,-1.02*2,-0.1*2,-0.2*2,
                   -0.05*2,-1*2,0,0.3*2,0.25*2,1.07*2,0.1*2,0.4*2,0.1*2,
                   2*2,0.2*2,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*2.5,-0.2*2.5,-1.05*2.5,0.2*2.5,-0.3*2.5,-0.1*2.5,-1.02*2.5,-0.1*2.5,-0.2*2.5,
                   -0.05*2.5,-1*2.5,0,0.3*2.5,0.25*2.5,1.07*2.5,0.1*2.5,0.4*2.5,0.1*2.5,
                   2*2.5,0.2*2.5,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*3,-0.2*3,-1.05*3,0.2*3,-0.3*3,-0.1*3,-1.02*3,-0.1*3,-0.2*3,
                   -0.05*3,-1*3,0,0.3*3,0.25*3,1.07*3,0.1*3,0.4*3,0.1*3,
                   2*3,0.2*3,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*3.5,-0.2*3.5,-1.05*3.5,0.2*3.5,-0.3*3.5,-0.1*3.5,-1.02*3.5,-0.1*3.5,-0.2*3.5,
                   -0.05*3.5,-1*3.5,0,0.3*3.5,0.25*3.5,1.07*3.5,0.1*3.5,0.4*3.5,0.1*3.5,
                   2*3.5,0.2*3.5,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)

X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*4,-0.2*4,-1.05*4,0.2*4,-0.3*4,-0.1*4,-1.02*4,-0.1*4,-0.2*4,
                   -0.05*4,-1*4,0,0.3*4,0.25*4,1.07*4,0.1*4,0.4*4,0.1*4,
                   2*4,0.2*4,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*4.5,-0.2*4.5,-1.05*4.5,0.2*4.5,-0.3*4.5,-0.1*4.5,-1.02*4.5,-0.1*4.5,-0.2*4.5,
                   -0.05*4.5,-1*4.5,0,0.3*4.5,0.25*4.5,1.07*4.5,0.1*4.5,0.4*4.5,0.1*4.5,
                   2*4.5,0.2*4.5,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*5,-0.2*5,-1.05*5,0.2*5,-0.3*5,-0.1*5,-1.02*5,-0.1*5,-0.2*5,
                   -0.05*5,-1*5,0,0.3*5,0.25*5,1.07*5,0.1*5,0.4*5,0.1*5,
                   2*5,0.2*5,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*5.5,-0.2*5.5,-1.05*5.5,0.2*5.5,-0.3*5.5,-0.1*5.5,-1.02*5.5,-0.1*5.5,-0.2*5.5,
                   -0.05*5.5,-1*5.5,0,0.3*5.5,0.25*5.5,1.07*5.5,0.1*5.5,0.4*5.5,0.1*5.5,
                   2*5.5,0.2*5.5,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)
X=replicate(4,fun4(10,12,13,14,15,8,8,9,10,11,15,10,12,8,9,15,10,8,9,9,
                   -0.4*6,-0.2*6,-1.05*6,0.2*6,-0.3*6,-0.1*6,-1.02*6,-0.1*6,-0.2*6,
                   -0.05*6,-1*6,0,0.3*6,0.25*6,1.07*6,0.1*6,0.4*6,0.1*6,
                   2*6,0.2*6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6,2,3,4,5,6))
mean(X)











X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

