rm(list=ls())

fun1<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{
  g11<-rnorm(n11,0,sqrt(v11));g12<-rnorm(n12,0,sqrt(v12))
  g13<-rnorm(n13,0,sqrt(v13));g14<-rnorm(n14,0,sqrt(v14))
  g21<-rnorm(n21,0,sqrt(v21));g22<-rnorm(n22,0,sqrt(v22))
  g23<-rnorm(n23,0,sqrt(v23));g24<-rnorm(n24,0,sqrt(v24))
  g31<-rnorm(n31,0,sqrt(v31));g32<-rnorm(n32,0,sqrt(v32))
  g33<-rnorm(n33,0,sqrt(v33));g34<-rnorm(n34,0,sqrt(v34))
  g41<-rnorm(n41,0,sqrt(v41));g42<-rnorm(n42,0,sqrt(v42))
  g43<-rnorm(n43,0,sqrt(v43));g44<-rnorm(n44,0,sqrt(v44))
  g51<-rnorm(n51,0,sqrt(v51));g52<-rnorm(n52,0,sqrt(v52))
  g53<-rnorm(n53,0,sqrt(v53));g54<-rnorm(n54,0,sqrt(v54))
  s11=var(g11);s12=var(g12);s13=var(g13);s14=var(g14)
  s21=var(g21);s22=var(g22);s23=var(g23);s24=var(g24)
  s31=var(g31);s32=var(g32);s33=var(g33);s34=var(g34)
  s41=var(g41);s42=var(g42);s43=var(g43);s44=var(g44)
  s51=var(g51);s52=var(g52);s53=var(g53);s54=var(g54)
  X11=mean(g11);X12=mean(g12);X13=mean(g13);X14=mean(g14)
  X21=mean(g21);X22=mean(g22);X23=mean(g23);X24=mean(g24)
  X31=mean(g31);X32=mean(g32);X33=mean(g33);X34=mean(g34)
  X41=mean(g41);X42=mean(g42);X43=mean(g43);X44=mean(g44)
  X51=mean(g51);X52=mean(g52);X53=mean(g53);X54=mean(g54)
  S1=(s21/n21+s11/n11);S2=(s22/n22+s12/n12);S3=(s23/n23+s13/n13);S4=(s24/n24+s14/n14)
  S5=(s31/n31+s21/n21);S6=(s32/n32+s22/n22);S7=(s33/n33+s23/n23);S8=(s34/n34+s24/n24)
  S9=(s41/n41+s31/n31);S10=(s42/n42+s32/n32);S11=(s43/n43+s33/n33);S12=(s44/n44+s34/n34)
  S13=(s51/n51+s41/n41);S14=(s52/n52+s42/n42);S15=(s53/n53+s43/n43);S16=(s54/n54+s44/n44)
  T11=(X21-X11)/sqrt(S1);T12=(X22-X12)/sqrt(S2);T13=(X23-X13)/sqrt(S3);T14=(X24-X14)/sqrt(S4)
  T21=(X31-X21)/sqrt(S5);T22=(X32-X22)/sqrt(S6);T23=(X33-X23)/sqrt(S7);T24=(X34-X24)/sqrt(S8)
  T31=(X41-X31)/sqrt(S9);T32=(X42-X32)/sqrt(S10);T33=(X43-X33)/sqrt(S11);T34=(X44-X34)/sqrt(S12)
  T41=(X51-X41)/sqrt(S13);T42=(X52-X42)/sqrt(S14);T43=(X53-X43)/sqrt(S15);T44=(X54-X44)/sqrt(S16)
  # NMT test statistic value
  T.1=max(T11,T21,T31,T41);T.2=max(T12,T22,T32,T42);T.3=max(T13,T23,T33,T43);T.4=max(T14,T24,T34,T44)
  TNM=min(T.1,T.2,T.3,T.4,na.rm = FALSE)
  return(TNM)
}
fun2<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{
  x=replicate(1000,fun1(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
                       v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54))
  y<-sort(x,decreasing=FALSE)
  c<-y[950]
  return(c)
}
fun3<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,mu41,mu42,mu43,mu44,
               mu51,mu52,mu53,mu54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{

  g11<-rnorm(n11,mu11,sqrt(v11));g12<-rnorm(n12,mu12,sqrt(v12))
  g13<-rnorm(n13,mu13,sqrt(v13));g14<-rnorm(n14,mu14,sqrt(v14))
  g21<-rnorm(n21,mu21,sqrt(v21));g22<-rnorm(n22,mu22,sqrt(v22))
  g23<-rnorm(n23,mu23,sqrt(v23));g24<-rnorm(n24,mu24,sqrt(v24))
  g31<-rnorm(n31,mu31,sqrt(v31));g32<-rnorm(n32,mu32,sqrt(v32))
  g33<-rnorm(n33,mu33,sqrt(v33));g34<-rnorm(n34,mu34,sqrt(v34))
  g41<-rnorm(n41,mu41,sqrt(v41));g42<-rnorm(n42,mu42,sqrt(v42))
  g43<-rnorm(n43,mu43,sqrt(v43));g44<-rnorm(n44,mu44,sqrt(v44))
  g51<-rnorm(n51,mu51,sqrt(v51));g52<-rnorm(n52,mu52,sqrt(v52))
  g53<-rnorm(n53,mu53,sqrt(v53));g54<-rnorm(n54,mu54,sqrt(v54))
  s11=var(g11);s12=var(g12);s13=var(g13);s14=var(g14)
  s21=var(g21);s22=var(g22);s23=var(g23);s24=var(g24)
  s31=var(g31);s32=var(g32);s33=var(g33);s34=var(g34)
  s41=var(g41);s42=var(g42);s43=var(g43);s44=var(g44)
  s51=var(g51);s52=var(g52);s53=var(g53);s54=var(g54)
  X11=mean(g11);X12=mean(g12);X13=mean(g13);X14=mean(g14)
  X21=mean(g21);X22=mean(g22);X23=mean(g23);X24=mean(g24)
  X31=mean(g31);X32=mean(g32);X33=mean(g33);X34=mean(g34)
  X41=mean(g41);X42=mean(g42);X43=mean(g43);X44=mean(g44)
  X51=mean(g51);X52=mean(g52);X53=mean(g53);X54=mean(g54)
  S1=(s21/n21+s11/n11);S2=(s22/n22+s12/n12);S3=(s23/n23+s13/n13);S4=(s24/n24+s14/n14)
  S5=(s31/n31+s21/n21);S6=(s32/n32+s22/n22);S7=(s33/n33+s23/n23);S8=(s34/n34+s24/n24)
  S9=(s41/n41+s31/n31);S10=(s42/n42+s32/n32);S11=(s43/n43+s33/n33);S12=(s44/n44+s34/n34)
  S13=(s51/n51+s41/n41);S14=(s52/n52+s42/n42);S15=(s53/n53+s43/n43);S16=(s54/n54+s44/n44)
  T11=(X21-X11)/sqrt(S1);T12=(X22-X12)/sqrt(S2);T13=(X23-X13)/sqrt(S3);T14=(X24-X14)/sqrt(S4)
  T21=(X31-X21)/sqrt(S5);T22=(X32-X22)/sqrt(S6);T23=(X33-X23)/sqrt(S7);T24=(X34-X24)/sqrt(S8)
  T31=(X41-X31)/sqrt(S9);T32=(X42-X32)/sqrt(S10);T33=(X43-X33)/sqrt(S11);T34=(X44-X34)/sqrt(S12)
  T41=(X51-X41)/sqrt(S13);T42=(X52-X42)/sqrt(S14);T43=(X53-X43)/sqrt(S15);T44=(X54-X44)/sqrt(S16)
  # max-T value
  T.1=max(T11,T21,T31,T41);T.2=max(T12,T22,T32,T42);T.3=max(T13,T23,T33,T43);T.4=max(T14,T24,T34,T44)
  TNM=min(T.1,T.2,T.3,T.4,na.rm = FALSE)
  out<-fun2(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
            s11,s12,s13,s14,s21,s22,s23,s24,s31,s32,s33,s34,s41,s42,s43,s44,s51,s52,s53,s54)
  a=0
  if(TNM>out)
    a=a+1
  return(a)
}
fun4<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,mu41,mu42,mu43,mu44,
               mu51,mu52,mu53,mu54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{
  out<-replicate(1000,fun3(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
                           mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,mu41,mu42,mu43,mu44,
                           mu51,mu52,mu53,mu54,
                           v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54))
  value<-mean(out)
  return(value)
}

X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*1.5,0.1*1.5,0.1*1.5,0.1*1.5,0.2*1.5,0.2*1.5,0.2*1.5,0.2*1.5,0.3*1.5,0.3*1.5,
                   0.3*1.5,0.3*1.5,0.4*1.5,0.4*1.5,0.4*1.5,0.4*1.5,0.5*1.5,0.5*1.5,0.5*1.5,0.5*1.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*2,0.1*2,0.1*2,0.1*2,0.2*2,0.2*2,0.2*2,0.2*2,0.3*2,0.3*2,
                   0.3*2,0.3*2,0.4*2,0.4*2,0.4*2,0.4*2,0.5*2,0.5*2,0.5*2,0.5*2,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*2.5,0.1*2.5,0.1*2.5,0.1*2.5,0.2*2.5,0.2*2.5,0.2*2.5,0.2*2.5,0.3*2.5,0.3*2.5,
                   0.3*2.5,0.3*2.5,0.4*2.5,0.4*2.5,0.4*2.5,0.4*2.5,0.5*2.5,0.5*2.5,0.5*2.5,0.5*2.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)

X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*3,0.1*3,0.1*3,0.1*3,0.2*3,0.2*3,0.2*3,0.2*3,0.3*3,0.3*3,
                   0.3*3,0.3*3,0.4*3,0.4*3,0.4*3,0.4*3,0.5*3,0.5*3,0.5*3,0.5*3,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*3.5,0.1*3.5,0.1*3.5,0.1*3.5,0.2*3.5,0.2*3.5,0.2*3.5,0.2*3.5,0.3*3.5,0.3*3.5,
                   0.3*3.5,0.3*3.5,0.4*3.5,0.4*3.5,0.4*3.5,0.4*3.5,0.5*3.5,0.5*3.5,0.5*3.5,0.5*3.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*4,0.1*4,0.1*4,0.1*4,0.2*4,0.2*4,0.2*4,0.2*4,0.3*4,0.3*4,
                   0.3*4,0.3*4,0.4*4,0.4*4,0.4*4,0.4*4,0.5*4,0.5*4,0.5*4,0.5*4,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*4.5,0.1*4.5,0.1*4.5,0.1*4.5,0.2*4.5,0.2*4.5,0.2*4.5,0.2*4.5,0.3*4.5,0.3*4.5,
                   0.3*4.5,0.3*4.5,0.4*4.5,0.4*4.5,0.4*4.5,0.4*4.5,0.5*4.5,0.5*4.5,0.5*4.5,0.5*4.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*5,0.1*5,0.1*5,0.1*5,0.2*5,0.2*5,0.2*5,0.2*5,0.3*5,0.3*5,
                   0.3*5,0.3*5,0.4*5,0.4*5,0.4*5,0.4*5,0.5*5,0.5*5,0.5*5,0.5*5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*5.5,0.1*5.5,0.1*5.5,0.1*5.5,0.2*5.5,0.2*5.5,0.2*5.5,0.2*5.5,0.3*5.5,0.3*5.5,
                   0.3*5.5,0.3*5.5,0.4*5.5,0.4*5.5,0.4*5.5,0.4*5.5,0.5*5.5,0.5*5.5,0.5*5.5,0.5*5.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*6,0.1*6,0.1*6,0.1*6,0.2*6,0.2*6,0.2*6,0.2*6,0.3*6,0.3*6,
                   0.3*6,0.3*6,0.4*6,0.4*6,0.4*6,0.4*6,0.5*6,0.5*6,0.5*6,0.5*6,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*6.5,0.1*6.5,0.1*6.5,0.1*6.5,0.2*6.5,0.2*6.5,0.2*6.5,0.2*6.5,0.3*6.5,0.3*6.5,
                   0.3*6.5,0.3*6.5,0.4*6.5,0.4*6.5,0.4*6.5,0.4*6.5,0.5*6.5,0.5*6.5,0.5*6.5,0.5*6.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*7,0.1*7,0.1*7,0.1*7,0.2*7,0.2*7,0.2*7,0.2*7,0.3*7,0.3*7,
                   0.3*7,0.3*7,0.4*7,0.4*7,0.4*7,0.4*7,0.5*7,0.5*7,0.5*7,0.5*7,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*7.5,0.1*7.5,0.1*7.5,0.1*7.5,0.2*7.5,0.2*7.5,0.2*7.5,0.2*7.5,0.3*7.5,0.3*7.5,
                   0.3*7.5,0.3*7.5,0.4*7.5,0.4*7.5,0.4*7.5,0.4*7.5,0.5*7.5,0.5*7.5,0.5*7.5,0.5*7.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*8,0.1*8,0.1*8,0.1*8,0.2*8,0.2*8,0.2*8,0.2*8,0.3*8,0.3*8,
                   0.3*8,0.3*8,0.4*8,0.4*8,0.4*8,0.4*8,0.5*8,0.5*8,0.5*8,0.5*8,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0.1*8.5,0.1*8.5,0.1*8.5,0.1*8.5,0.2*8.5,0.2*8.5,0.2*8.5,0.2*8.5,0.3*8.5,0.3*8.5,
                   0.3*8.5,0.3*8.5,0.4*8.5,0.4*8.5,0.4*8.5,0.4*8.5,0.5*8.5,0.5*8.5,0.5*8.5,0.5*8.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)




X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2,-0.2,-0.2,-0.2,-0.1,-0.1,-0.1,-0.1,0,0,0,0,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)

X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*1.5,-0.2*1.5,-0.2*1.5,-0.2*1.5,-0.1*1.5,-0.1*1.5,-0.1*1.5,-0.1*1.5,0,0,0,0,
                   0.1*1.5,0.1*1.5,0.1*1.5,0.1*1.5,0.2*1.5,0.2*1.5,0.2*1.5,0.2*1.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*2,-0.2*2,-0.2*2,-0.2*2,-0.1*2,-0.1*2,-0.1*2,-0.1*2,0,0,0,0,
                   0.1*2,0.1*2,0.1*2,0.1*2,0.2*2,0.2*2,0.2*2,0.2*2,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*2.5,-0.2*2.5,-0.2*2.5,-0.2*2.5,-0.1*2.5,-0.1*2.5,-0.1*2.5,-0.1*2.5,0,0,0,0,
                   0.1*2.5,0.1*2.5,0.1*2.5,0.1*2.5,0.2*2.5,0.2*2.5,0.2*2.5,0.2*2.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*3,-0.2*3,-0.2*3,-0.2*3,-0.1*3,-0.1*3,-0.1*3,-0.1*3,0,0,0,0,
                   0.1*3,0.1*3,0.1*3,0.1*3,0.2*3,0.2*3,0.2*3,0.2*3,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*3.5,-0.2*3.5,-0.2*3.5,-0.2*3.5,-0.1*3.5,-0.1*3.5,-0.1*3.5,-0.1*3.5,0,0,0,0,
                   0.1*3.5,0.1*3.5,0.1*3.5,0.1*3.5,0.2*3.5,0.2*3.5,0.2*3.5,0.2*3.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*4,-0.2*4,-0.2*4,-0.2*4,-0.1*4,-0.1*4,-0.1*4,-0.1*4,0,0,0,0,
                   0.1*4,0.1*4,0.1*4,0.1*4,0.2*4,0.2*4,0.2*4,0.2*4,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*4.5,-0.2*4.5,-0.2*4.5,-0.2*4.5,-0.1*4.5,-0.1*4.5,-0.1*4.5,-0.1*4.5,0,0,0,0,
                   0.1*4.5,0.1*4.5,0.1*4.5,0.1*4.5,0.2*4.5,0.2*4.5,0.2*4.5,0.2*4.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*5,-0.2*5,-0.2*5,-0.2*5,-0.1*5,-0.1*5,-0.1*5,-0.1*5,0,0,0,0,
                   0.1*5,0.1*5,0.1*5,0.1*5,0.2*5,0.2*5,0.2*5,0.2*5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*5.5,-0.2*5.5,-0.2*5.5,-0.2*5.5,-0.1*5.5,-0.1*5.5,-0.1*5.5,-0.1*5.5,0,0,0,0,
                   0.1*5.5,0.1*5.5,0.1*5.5,0.1*5.5,0.2*5.5,0.2*5.5,0.2*5.5,0.2*5.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*6,-0.2*6,-0.2*6,-0.2*6,-0.1*6,-0.1*6,-0.1*6,-0.1*6,0,0,0,0,
                   0.1*6,0.1*6,0.1*6,0.1*6,0.2*6,0.2*6,0.2*6,0.2*6,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*6.5,-0.2*6.5,-0.2*6.5,-0.2*6.5,-0.1*6.5,-0.1*6.5,-0.1*6.5,-0.1*6.5,0,0,0,0,
                   0.1*6.5,0.1*6.5,0.1*6.5,0.1*6.5,0.2*6.5,0.2*6.5,0.2*6.5,0.2*6.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*7,-0.2*7,-0.2*7,-0.2*7,-0.1*7,-0.1*7,-0.1*7,-0.1*7,0,0,0,0,
                   0.1*7,0.1*7,0.1*7,0.1*7,0.2*7,0.2*7,0.2*7,0.2*7,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*7.5,-0.2*7.5,-0.2*7.5,-0.2*7.5,-0.1*7.5,-0.1*7.5,-0.1*7.5,-0.1*7.5,0,0,0,0,
                   0.1*7.5,0.1*7.5,0.1*7.5,0.1*7.5,0.2*7.5,0.2*7.5,0.2*7.5,0.2*7.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*8,-0.2*8,-0.2*8,-0.2*8,-0.1*8,-0.1*8,-0.1*8,-0.1*8,0,0,0,0,
                   0.1*8,0.1*8,0.1*8,0.1*8,0.2*8,0.2*8,0.2*8,0.2*8,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*8.5,-0.2*8.5,-0.2*8.5,-0.2*8.5,-0.1*8.5,-0.1*8.5,-0.1*8.5,-0.1*8.5,0,0,0,0,
                   0.1*8.5,0.1*8.5,0.1*8.5,0.1*8.5,0.2*8.5,0.2*8.5,0.2*8.5,0.2*8.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*9,-0.2*9,-0.2*9,-0.2*9,-0.1*9,-0.1*9,-0.1*9,-0.1*9,0,0,0,0,
                   0.1*9,0.1*9,0.1*9,0.1*9,0.2*9,0.2*9,0.2*9,0.2*9,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*9.5,-0.2*9.5,-0.2*9.5,-0.2*9.5,-0.1*9.5,-0.1*9.5,-0.1*9.5,-0.1*9.5,0,0,0,0,
                   0.1*9.5,0.1*9.5,0.1*9.5,0.1*9.5,0.2*9.5,0.2*9.5,0.2*9.5,0.2*9.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*10,-0.2*10,-0.2*10,-0.2*10,-0.1*10,-0.1*10,-0.1*10,-0.1*10,0,0,0,0,
                   0.1*10,0.1*10,0.1*10,0.1*10,0.2*10,0.2*10,0.2*10,0.2*10,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*10.5,-0.2*10.5,-0.2*10.5,-0.2*10.5,-0.1*10.5,-0.1*10.5,-0.1*10.5,-0.1*10.5,0,0,0,0,
                   0.1*10.5,0.1*10.5,0.1*10.5,0.1*10.5,0.2*10.5,0.2*10.5,0.2*10.5,0.2*10.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*11,-0.2*11,-0.2*11,-0.2*11,-0.1*11,-0.1*11,-0.1*11,-0.1*11,0,0,0,0,
                   0.1*11,0.1*11,0.1*11,0.1*11,0.2*11,0.2*11,0.2*11,0.2*11,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*11.5,-0.2*11.5,-0.2*11.5,-0.2*11.5,-0.1*11.5,-0.1*11.5,-0.1*11.5,-0.1*11.5,0,0,0,0,
                   0.1*11.5,0.1*11.5,0.1*11.5,0.1*11.5,0.2*11.5,0.2*11.5,0.2*11.5,0.2*11.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*12,-0.2*12,-0.2*12,-0.2*12,-0.1*12,-0.1*12,-0.1*12,-0.1*12,0,0,0,0,
                   0.1*12,0.1*12,0.1*12,0.1*12,0.2*12,0.2*12,0.2*12,0.2*12,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*12.5,-0.2*12.5,-0.2*12.5,-0.2*12.5,-0.1*12.5,-0.1*12.5,-0.1*12.5,-0.1*12.5,0,0,0,0,
                   0.1*12.5,0.1*12.5,0.1*12.5,0.1*12.5,0.2*12.5,0.2*12.5,0.2*12.5,0.2*12.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*13,-0.2*13,-0.2*13,-0.2*13,-0.1*13,-0.1*13,-0.1*13,-0.1*13,0,0,0,0,
                   0.1*13,0.1*13,0.1*13,0.1*13,0.2*13,0.2*13,0.2*13,0.2*13,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*13.5,-0.2*13.5,-0.2*13.5,-0.2*13.5,-0.1*13.5,-0.1*13.5,-0.1*13.5,-0.1*13.5,0,0,0,0,
                   0.1*13.5,0.1*13.5,0.1*13.5,0.1*13.5,0.2*13.5,0.2*13.5,0.2*13.5,0.2*13.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*14,-0.2*14,-0.2*14,-0.2*14,-0.1*14,-0.1*14,-0.1*14,-0.1*14,0,0,0,0,
                   0.1*14,0.1*14,0.1*14,0.1*14,0.2*14,0.2*14,0.2*14,0.2*14,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*14.5,-0.2*14.5,-0.2*14.5,-0.2*14.5,-0.1*14.5,-0.1*14.5,-0.1*14.5,-0.1*14.5,0,0,0,0,
                   0.1*14.5,0.1*14.5,0.1*14.5,0.1*14.5,0.2*14.5,0.2*14.5,0.2*14.5,0.2*14.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   -0.2*15,-0.2*15,-0.2*15,-0.2*15,-0.1*15,-0.1*15,-0.1*15,-0.1*15,0,0,0,0,
                   0.1*15,0.1*15,0.1*15,0.1*15,0.2*15,0.2*15,0.2*15,0.2*15,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)


X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   1,1,1,0.1,1.2,1.2,1.3,0.2,1.2,1.3,1.4,0.4,
                   1.4,1.4,1.5,0.5,1.6,1.5,1.6,0.7,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   2.5,2.5,2.5,0.1*2.5,1.2*2.5,1.2*2.5,1.3*2.5,0.2*2.5,1.2*2.5,1.3*2.5,1.4*2.5,0.4*2.5,
                   1.4*2.5,1.4*2.5,1.5*2.5,0.5*2.5,1.6*2.5,1.5*2.5,1.6*2.5,0.7*2.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   4.5,4.5,4.5,0.1*4.5,1.2*4.5,1.2*4.5,1.3*4.5,0.2*4.5,1.2*4.5,1.3*4.5,1.4*4.5,0.4*4.5,
                   1.4*4.5,1.4*4.5,1.5*4.5,0.5*4.5,1.6*4.5,1.5*4.5,1.6*4.5,0.7*4.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   6.5,6.5,6.5,0.1*6.5,1.2*6.5,1.2*6.5,1.3*6.5,0.2*6.5,1.2*6.5,1.3*6.5,1.4*6.5,0.4*6.5,
                   1.4*6.5,1.4*6.5,1.5*6.5,0.5*6.5,1.6*6.5,1.5*6.5,1.6*6.5,0.7*6.5,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   7,7,7,0.1*7,1.2*7,1.2*7,1.3*7,0.2*7,1.2*7,1.3*7,1.4*7,0.4*7,
                   1.4*7,1.4*7,1.5*7,0.5*7,1.6*7,1.5*7,1.6*7,0.7*7,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)

X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   2.1*2,0.2*2,0.1*2,1.1*2,2.2*2,0.4*2,0.2*2,1.3*2,2.4*2,
                   0.6*2,0.3*2,1.4*2,2.5*2,0.7*2,0.4*2,1.5*2,2.6*2,0.8*2,0.5*2,1.6*2,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)

X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   2.1*4,0.2*4,0.1*4,1.1*4,2.2*4,0.4*4,0.2*4,1.3*4,2.4*4,
                   0.6*4,0.3*4,1.4*4,2.5*4,0.7*4,0.4*4,1.5*4,2.6*4,0.8*4,0.5*4,1.6*4,
                   1,4,4,9,16,1,4,4,9,16,1,4,4,9,16,1,4,4,9,16))
mean(X)









X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

